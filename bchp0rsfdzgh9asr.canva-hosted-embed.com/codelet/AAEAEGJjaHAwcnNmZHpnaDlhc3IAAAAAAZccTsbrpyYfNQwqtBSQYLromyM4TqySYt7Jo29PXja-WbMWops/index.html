<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>DriverFinance - Controle Financeiro para Motoristas</title>
<script src="https://cdn.tailwindcss.com">
function generateReport() {
    // Simula o comando de impressão (Ctrl+P) para que a janela de impressão seja aberta
    window.print();
}
</script>
<script src="https://cdn.jsdelivr.net/npm/chart.js">
function generateReport() {
    // Simula o comando de impressão (Ctrl+P) para que a janela de impressão seja aberta
    window.print();
}
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js">
function generateReport() {
    // Simula o comando de impressão (Ctrl+P) para que a janela de impressão seja aberta
    window.print();
}
</script>
<style>
@keyframes glowBorder {
    0% {
        transform: translateX(-100%);
    }
    100% {
        transform: translateX(100%);
    }
}

.card {
    position: relative;
    overflow: hidden;
}

.card:hover::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--netflix-red), transparent);
    animation: glowBorder 2s linear infinite;
}

        :root {
            --netflix-red: #E50914;
            --netflix-black: #141414;
            --netflix-dark-gray: #181818;
            --netflix-light-gray: #2F2F2F;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--netflix-black);
            color: white;
        }

        .netflix-btn {
            background-color: var(--netflix-red);
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .netflix-btn:hover {
            background-color: #f40612;
            transform: scale(1.05);
        }

        .card {
            background-color: var(--netflix-dark-gray);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .filter-btn {
            background-color: var(--netflix-light-gray);
            color: #ccc;
            border-radius: 20px;
            padding: 6px 16px;
            transition: all 0.2s ease;
        }

        .filter-btn.active {
            background-color: var(--netflix-red);
            color: white;
        }

        .filter-btn:hover:not(.active) {
            background-color: #3a3a3a;
            color: white;
        }

        .modal {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-content {
            background-color: var(--netflix-dark-gray);
            border-radius: 8px;
        }

        input,
        select {
            background-color: var(--netflix-light-gray);
            border: 1px solid #444;
            color: white;
        }

        input:focus,
        select:focus {
            border-color: var(--netflix-red);
            outline: none;
        }

        table th {
            background-color: var(--netflix-light-gray);
        }

        table tr:nth-child(even) {
            background-color: rgba(47, 47, 47, 0.5);
        }

        table tr:hover {
            background-color: rgba(229, 9, 20, 0.1);
        }

        .icon-btn {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .icon-btn:hover {
            transform: scale(1.2);
        }

        .pagination-btn {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pagination-btn:hover:not(.active) {
            background-color: #3a3a3a !important;
        }

        .pagination-btn.active {
            background-color: var(--netflix-red) !important;
            color: white !important;
        }

        /* Scrollbar customization */

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--netflix-black);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--netflix-light-gray);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--netflix-red);
        }

        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            text-align: center;
        }
    </style>
</head>
<body class="min-h-screen">
<header class="py-4 px-6 md:px-12 flex justify-between items-center border-b border-gray-800">
<div class="flex items-center">
<svg class="w-8 h-8 text-red-600 mr-2" fill="currentColor" viewbox="0 0 20 20">
<path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM14 11a1 1 0 011 1v1h1a1 1 0 110 2h-1v1a1 1 0 11-2 0v-1h-1a1 1 0 110-2h1v-1a1 1 0 011-1z"></path>
</svg>
<h1 class="text-2xl font-bold">DriverFinance</h1>
</div>
<div class="flex items-center">
<div class="mr-4 hidden md:block">
<span class="text-gray-400">Olá, </span>
<span class="font-medium">Motorista</span>
</div>
<button class="netflix-btn flex items-center" id="addTransactionBtn">
<svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M12 6v6m0 0v6m0-6h6m-6 0H6" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
                Novo Lançamento
            </button>
</div>
</header>
<main class="py-6 px-6 md:px-12">
<!-- Filtros -->
<div class="mb-8">
<h2 class="text-xl font-semibold mb-4">Período</h2>
<div class="flex flex-wrap gap-2">
<button class="filter-btn" data-period="day">Dia</button>
<button class="filter-btn" data-period="week">Semana</button>
<button class="filter-btn active" data-period="month">Mês</button>
<button class="filter-btn" data-period="semester">Semestre</button>
<button class="filter-btn" data-period="year">Ano</button>
</div>
</div>
<!-- Resumo -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
<div class="card p-6">
<h3 class="text-gray-400 mb-1">Ganhos Total</h3>
<div class="text-2xl font-bold" id="totalIncome">R$ 0,00</div>
<div class="text-green-500 text-sm mt-2 flex items-center" id="incomeComparison">
<span>Sem dados anteriores</span>
</div>
</div>
<div class="card p-6">
<h3 class="text-gray-400 mb-1">Despesas</h3>
<div class="text-2xl font-bold" id="totalExpenses">R$ 0,00</div>
<div class="text-red-500 text-sm mt-2 flex items-center" id="expensesComparison">
<span>Sem dados anteriores</span>
</div>
</div>
<div class="card p-6">
<h3 class="text-gray-400 mb-1">Lucro Líquido</h3>
<div class="text-2xl font-bold" id="netProfit">R$ 0,00</div>
<div class="text-green-500 text-sm mt-2 flex items-center" id="profitComparison">
<span>Sem dados anteriores</span>
</div>
</div>
<div class="card p-6">
<h3 class="text-gray-400 mb-1">Corridas</h3>
<div class="text-2xl font-bold" id="totalRides">0</div>
<div class="text-green-500 text-sm mt-2 flex items-center" id="ridesComparison">
<span>Sem dados anteriores</span>
</div>
</div>
</div>
<!-- Gráficos -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
<div class="card p-6">
<h3 class="text-lg font-semibold mb-4">Ganhos vs Despesas</h3>
<div class="h-64" id="incomeExpensesChartContainer">
<canvas id="incomeExpensesChart"></canvas>
<div class="empty-state hidden" id="incomeExpensesEmptyState">
<svg class="w-16 h-16 text-gray-600 mb-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"></path>
</svg>
<p class="text-gray-400">Sem dados para exibir</p>
<p class="text-gray-500 text-sm mt-2">Adicione lançamentos para visualizar o gráfico</p>
</div>
</div>
</div>
<div class="card p-6">
<h3 class="text-lg font-semibold mb-4">Categorias de Despesas</h3>
<div class="h-64" id="expenseCategoriesChartContainer">
<canvas id="expenseCategoriesChart"></canvas>
<div class="empty-state hidden" id="expenseCategoriesEmptyState">
<svg class="w-16 h-16 text-gray-600 mb-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"></path>
<path d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"></path>
</svg>
<p class="text-gray-400">Sem despesas para exibir</p>
<p class="text-gray-500 text-sm mt-2">Adicione despesas para visualizar o gráfico</p>
</div>
</div>
</div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
<div class="card p-6">
<h3 class="text-lg font-semibold mb-4">Desempenho por Dia da Semana</h3>
<div class="h-64" id="weekdayPerformanceChartContainer">
<canvas id="weekdayPerformanceChart"></canvas>
<div class="empty-state hidden" id="weekdayPerformanceEmptyState">
<svg class="w-16 h-16 text-gray-600 mb-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"></path>
</svg>
<p class="text-gray-400">Sem dados para exibir</p>
<p class="text-gray-500 text-sm mt-2">Adicione lançamentos para visualizar o desempenho</p>
</div>
</div>
</div>
<div class="card p-6">
<h3 class="text-lg font-semibold mb-4">Lucro Líquido (Tendência)</h3>
<div class="h-64" id="profitTrendChartContainer">
<canvas id="profitTrendChart"></canvas>
<div class="empty-state hidden" id="profitTrendEmptyState">
<svg class="w-16 h-16 text-gray-600 mb-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"></path>
</svg>
<p class="text-gray-400">Sem dados para exibir</p>
<p class="text-gray-500 text-sm mt-2">Adicione lançamentos para visualizar a tendência</p>
</div>
</div>
</div>
</div>
<!-- Tabela de Transações -->
<div class="card p-6 mb-8">
<div class="flex justify-between items-center mb-4">
<h3 class="text-lg font-semibold">Últimas Transações</h3>
<div class="relative">
<input class="py-2 px-4 rounded-full text-sm w-full md:w-64" id="searchInput" placeholder="Buscar transação..." type="text"/>
<svg class="w-5 h-5 text-gray-400 absolute right-3 top-2.5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
<div class="overflow-x-auto">
<table class="w-full text-left">
<thead>
<tr class="text-gray-400">
<th class="py-3 px-4 rounded-tl-lg">Data</th>
<th class="py-3 px-4">Descrição</th>
<th class="py-3 px-4">Categoria</th>
<th class="py-3 px-4">Tipo</th>
<th class="py-3 px-4">Valor</th>
<th class="py-3 px-4">Corridas</th>
<th class="py-3 px-4 rounded-tr-lg">Ações</th>
</tr>
</thead>
<tbody id="transactionsTable">
<!-- Dados serão inseridos via JavaScript -->
</tbody>
</table>
<div class="py-8 text-center hidden" id="emptyTransactionsMessage">
<svg class="w-16 h-16 text-gray-600 mx-auto mb-4" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"></path>
</svg>
<p class="text-gray-400">Nenhuma transação encontrada</p>
<p class="text-gray-500 text-sm mt-2">Clique em "Novo Lançamento" para adicionar sua primeira transação</p>
</div>
</div>
<div class="mt-4 flex justify-between items-center">
<div class="text-sm text-gray-400" id="paginationInfo">Mostrando 0 de 0 transações</div>
<div class="flex space-x-1" id="pagination">
<!-- Paginação será inserida via JavaScript -->
</div>
</div>
</div>
</main>
<footer class="py-6 px-6 md:px-12 border-t border-gray-800">
<div class="flex flex-col md:flex-row justify-between items-center">
<div class="mb-4 md:mb-0">
<p class="text-gray-400">© 2023 DriverFinance - Controle Financeiro para Motoristas</p>
</div>
<div class="flex space-x-4">
<button class="netflix-btn flex items-center" id="exportPdfBtn" onclick="generateReport()">
<svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
                    Exportar PDF
                </button>
</div>
</div>
</footer>
<!-- Modal de Novo Lançamento -->
<div class="fixed inset-0 z-50 hidden modal flex items-center justify-center p-4" id="transactionModal">
<div class="modal-content w-full max-w-md p-6">
<div class="flex justify-between items-center mb-6">
<h3 class="text-xl font-semibold" id="modalTitle">Novo Lançamento</h3>
<button class="text-gray-400 hover:text-white" id="closeModalBtn">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<form id="transactionForm">
<input id="transactionId" type="hidden"/>
<div class="mb-4">
<label class="block text-gray-400 mb-2" for="transactionDate">Data</label>
<input class="w-full p-2 rounded" id="transactionDate" type="date"/>
</div>
<div class="mb-4">
<label class="block text-gray-400 mb-2" for="transactionDescription">Descrição</label>
<input class="w-full p-2 rounded" id="transactionDescription" placeholder="Ex: Uber - Corridas" type="text"/>
</div>
<div class="mb-4">
<label class="block text-gray-400 mb-2" for="transactionCategory">Categoria</label>
<select class="w-full p-2 rounded" id="transactionCategory">
<option value="ganhos">Ganhos</option>
<option value="combustivel">Combustível</option>
<option value="manutencao">Manutenção</option>
<option value="lavagem">Lavagem</option>
<option value="alimentacao">Alimentação</option>
<option value="taxas">Taxas e Impostos</option>
<option value="outros">Outros</option>
</select>
</div>
<div class="mb-4">
<label class="block text-gray-400 mb-2" for="transactionType">Tipo</label>
<div class="flex space-x-4">
<label class="flex items-center">
<input checked="" class="mr-2" id="incomeType" name="transactionType" type="radio" value="income"/>
<span>Entrada</span>
</label>
<label class="flex items-center">
<input class="mr-2" id="expenseType" name="transactionType" type="radio" value="expense"/>
<span>Saída</span>
</label>
</div>
</div>
<div class="mb-4">
<label class="block text-gray-400 mb-2" for="transactionAmount">Valor (R$)</label>
<input class="w-full p-2 rounded" id="transactionAmount" min="0" placeholder="0,00" step="0.01" type="number"/>
</div>
<div class="mb-6" id="ridesCountContainer">
<label class="block text-gray-400 mb-2" for="transactionRides">Número de Corridas</label>
<input class="w-full p-2 rounded" id="transactionRides" min="0" placeholder="0" type="number"/>
</div>
<div class="flex justify-end">
<button class="bg-gray-700 text-white py-2 px-4 rounded mr-2 hover:bg-gray-600" id="cancelTransactionBtn" type="button">Cancelar</button>
<button class="netflix-btn" type="submit">Salvar</button>
</div>
</form>
</div>
</div>
<!-- Modal de Confirmação de Exclusão -->
<div class="fixed inset-0 z-50 hidden modal flex items-center justify-center p-4" id="deleteConfirmModal">
<div class="modal-content w-full max-w-sm p-6">
<div class="flex justify-between items-center mb-6">
<h3 class="text-xl font-semibold">Confirmar Exclusão</h3>
<button class="text-gray-400 hover:text-white" id="closeDeleteModalBtn">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<p class="mb-6">Tem certeza que deseja excluir esta transação? Esta ação não pode ser desfeita.</p>
<div class="flex justify-end">
<button class="bg-gray-700 text-white py-2 px-4 rounded mr-2 hover:bg-gray-600" id="cancelDeleteBtn" type="button">Cancelar</button>
<button class="bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700" id="confirmDeleteBtn" type="button">Excluir</button>
</div>
</div>
</div>
<script>
        // Variáveis globais
        let currentPeriod = 'month';
        let charts = {};
        let currentTransactionId = null;
        let transactions = [];

        // Variáveis de paginação e busca
        let currentPage = 1;
        const itemsPerPage = 5;
        let filteredTransactions = [];
        let searchTerm = '';

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            loadTransactionsFromLocalStorage();
            initCharts();
            updateDashboard(currentPeriod);
            setupEventListeners();
            toggleRidesField();

            // Inicializar a tabela de transações com paginação
            filteredTransactions = [...transactions];
            updateTransactionsTable();

            // Adicionar event listeners para atualização em tempo real
            document.getElementById('transactionAmount').addEventListener('input', previewDashboardUpdate);
            document.getElementById('transactionRides').addEventListener('input', previewDashboardUpdate);
            document.getElementById('incomeType').addEventListener('change', previewDashboardUpdate);
            document.getElementById('expenseType').addEventListener('change', previewDashboardUpdate);
            document.getElementById('transactionCategory').addEventListener('change', previewDashboardUpdate);
        });

        // Carregar transações do localStorage
        function loadTransactionsFromLocalStorage() {
            const savedTransactions = localStorage.getItem('driverFinanceTransactions');
            if (savedTransactions) {
                transactions = JSON.parse(savedTransactions);
            }
        }

        // Salvar transações no localStorage
        function saveTransactionsToLocalStorage() {
            localStorage.setItem('driverFinanceTransactions', JSON.stringify(transactions));
        }

        // Inicializar gráficos
        function initCharts() {
            // Gráfico de Ganhos vs Despesas
            charts.incomeExpenses = new Chart(
                document.getElementById('incomeExpensesChart'), {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                                label: 'Ganhos',
                                backgroundColor: 'rgba(16, 185, 129, 0.8)',
                                borderColor: 'rgb(16, 185, 129)',
                                borderWidth: 1,
                                data: []
                            },
                            {
                                label: 'Despesas',
                                backgroundColor: 'rgba(239, 68, 68, 0.8)',
                                borderColor: 'rgb(239, 68, 68)',
                                borderWidth: 1,
                                data: []
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    color: 'white'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                }
            );

            // Gráfico de Categorias de Despesas
            charts.expenseCategories = new Chart(
                document.getElementById('expenseCategoriesChart'), {
                    type: 'doughnut',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(245, 158, 11, 0.8)',
                                'rgba(16, 185, 129, 0.8)',
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(139, 92, 246, 0.8)',
                                'rgba(236, 72, 153, 0.8)'
                            ],
                            borderColor: [
                                'rgb(239, 68, 68)',
                                'rgb(245, 158, 11)',
                                'rgb(16, 185, 129)',
                                'rgb(59, 130, 246)',
                                'rgb(139, 92, 246)',
                                'rgb(236, 72, 153)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    color: 'white'
                                }
                            }
                        }
                    }
                }
            );

            // Gráfico de Desempenho por Dia da Semana
            charts.weekdayPerformance = new Chart(
                document.getElementById('weekdayPerformanceChart'), {
                    type: 'bar',
                    data: {
                        labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                        datasets: [{
                            label: 'Lucro Líquido',
                            backgroundColor: 'rgba(99, 102, 241, 0.8)',
                            borderColor: 'rgb(99, 102, 241)',
                            borderWidth: 1,
                            data: [0, 0, 0, 0, 0, 0, 0]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    color: 'white'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                }
            );

            // Gráfico de Tendência de Lucro
            charts.profitTrend = new Chart(
                document.getElementById('profitTrendChart'), {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Lucro Líquido',
                            backgroundColor: 'rgba(16, 185, 129, 0.2)',
                            borderColor: 'rgb(16, 185, 129)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgb(16, 185, 129)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(16, 185, 129)',
                            fill: true,
                            tension: 0.4,
                            data: []
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    color: 'white'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                },
                                beginAtZero: true
                            }
                        }
                    }
                }
            );
        }

        // Configurar event listeners
        function setupEventListeners() {
            // Filtros de período
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentPeriod = this.dataset.period;
                    updateDashboard(currentPeriod);
                });
            });

            // Botão de novo lançamento
            document.getElementById('addTransactionBtn').addEventListener('click', function() {
                openTransactionModal();
            });

            // Fechar modal
            document.getElementById('closeModalBtn').addEventListener('click', function() {
                closeTransactionModal();
            });

            document.getElementById('cancelTransactionBtn').addEventListener('click', function() {
                closeTransactionModal();
            });

            // Formulário de transação
            document.getElementById('transactionForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveTransaction();
            });

            // Modal de confirmação de exclusão
            document.getElementById('closeDeleteModalBtn').addEventListener('click', function() {
                closeDeleteConfirmModal();
            });

            document.getElementById('cancelDeleteBtn').addEventListener('click', function() {
                closeDeleteConfirmModal();
            });

            document.getElementById('confirmDeleteBtn').addEventListener('click', function() {
                deleteTransaction();
            });

            // Exportar PDF
            document.getElementById('exportPdfBtn').addEventListener('click', function() {
                exportToPdf();
            });

            // Mostrar/ocultar campo de corridas com base no tipo de transação
            document.getElementById('incomeType').addEventListener('change', toggleRidesField);
            document.getElementById('expenseType').addEventListener('change', toggleRidesField);

            // Campo de busca
            document.getElementById('searchInput').addEventListener('input', function(e) {
                searchTerm = e.target.value.toLowerCase();
                currentPage = 1; // Resetar para a primeira página ao buscar
                filterTransactions();
            });
        }

        // Filtrar transações com base no termo de busca
        function filterTransactions() {
            if (!searchTerm) {
                filteredTransactions = [...transactions];
            } else {
                filteredTransactions = transactions.filter(transaction => {
                    const date = formatDate(transaction.date).toLowerCase();
                    const description = transaction.description.toLowerCase();
                    const category = transaction.category.toLowerCase();
                    const type = transaction.type === 'income' ? 'entrada' : 'saída';
                    const amount = transaction.amount.toString();
                    const rides = transaction.rides.toString();

                    return date.includes(searchTerm) ||
                        description.includes(searchTerm) ||
                        category.includes(searchTerm) ||
                        type.includes(searchTerm) ||
                        amount.includes(searchTerm) ||
                        rides.includes(searchTerm);
                });
            }

            updateTransactionsTable();
        }

        // Mostrar/ocultar campo de corridas com base no tipo de transação
        function toggleRidesField() {
            const ridesContainer = document.getElementById('ridesCountContainer');
            const isIncome = document.getElementById('incomeType').checked;

            if (isIncome) {
                ridesContainer.style.display = 'block';
            } else {
                ridesContainer.style.display = 'none';
                document.getElementById('transactionRides').value = 0;
            }
        }

        // Atualizar dashboard com base no período selecionado
        function updateDashboard(period) {
            const data = calculateDashboardData(period);

            // Atualizar resumo
            document.getElementById('totalIncome').textContent = formatCurrency(data.income);
            document.getElementById('totalExpenses').textContent = formatCurrency(data.expenses);
            document.getElementById('netProfit').textContent = formatCurrency(data.profit);
            document.getElementById('totalRides').textContent = data.rides;

            // Atualizar comparações
            updateComparisons(data);

            // Atualizar gráficos
            updateIncomeExpensesChart(data.incomeExpensesData);
            updateExpenseCategoriesChart(data.expenseCategoriesData);
            updateWeekdayPerformanceChart(data.weekdayPerformanceData);
            updateProfitTrendChart(data.profitTrendData);

            // Mostrar/ocultar estados vazios
            toggleEmptyStates(data);
        }

        // Calcular dados do dashboard com base nas transações
        function calculateDashboardData(period) {
            const now = new Date();
            let startDate;

            // Determinar a data de início com base no período
            switch (period) {
                case 'day':
                    startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    break;
                case 'week':
                    const dayOfWeek = now.getDay() || 7; // Converter 0 (domingo) para 7
                    startDate = new Date(now.getFullYear(), now.getMonth(), now.getDate() - dayOfWeek + 1);
                    break;
                case 'month':
                    startDate = new Date(now.getFullYear(), now.getMonth(), 1);
                    break;
                case 'semester':
                    const semesterStart = now.getMonth() < 6 ? 0 : 6;
                    startDate = new Date(now.getFullYear(), semesterStart, 1);
                    break;
                case 'year':
                    startDate = new Date(now.getFullYear(), 0, 1);
                    break;
            }

            // Filtrar transações do período
            const periodTransactions = transactions.filter(t => {
                const transactionDate = new Date(t.date);
                return transactionDate >= startDate && transactionDate <= now;
            });

            // Calcular totais
            let income = 0;
            let expenses = 0;
            let rides = 0;

            // Dados para gráficos
            let incomeExpensesData = initIncomeExpensesData(period, startDate);
            let expenseCategoriesData = {
                labels: [],
                data: []
            };
            let weekdayPerformanceData = {
                labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                data: [0, 0, 0, 0, 0, 0, 0]
            };
            let profitTrendData = initProfitTrendData(period, startDate);

            // Processar transações
            periodTransactions.forEach(transaction => {
                const transactionDate = new Date(transaction.date);

                if (transaction.type === 'income') {
                    income += transaction.amount;
                    rides += transaction.rides || 0;

                    // Atualizar gráfico de ganhos vs despesas
                    updateIncomeExpensesDataPoint(incomeExpensesData, transactionDate, transaction.amount, 0);

                    // Atualizar gráfico de lucro por dia da semana
                    const dayOfWeek = transactionDate.getDay() || 7; // Converter 0 (domingo) para 7
                    weekdayPerformanceData.data[dayOfWeek - 1] += transaction.amount;

                    // Atualizar gráfico de tendência de lucro
                    updateProfitTrendDataPoint(profitTrendData, transactionDate, transaction.amount);
                } else {
                    expenses += transaction.amount;

                    // Atualizar gráfico de ganhos vs despesas
                    updateIncomeExpensesDataPoint(incomeExpensesData, transactionDate, 0, transaction.amount);

                    // Atualizar gráfico de categorias de despesas
                    const categoryIndex = expenseCategoriesData.labels.indexOf(transaction.category);
                    if (categoryIndex !== -1) {
                        expenseCategoriesData.data[categoryIndex] += transaction.amount;
                    } else {
                        expenseCategoriesData.labels.push(transaction.category);
                        expenseCategoriesData.data.push(transaction.amount);
                    }

                    // Atualizar gráfico de lucro por dia da semana
                    const dayOfWeek = transactionDate.getDay() || 7; // Converter 0 (domingo) para 7
                    weekdayPerformanceData.data[dayOfWeek - 1] -= transaction.amount;

                    // Atualizar gráfico de tendência de lucro
                    updateProfitTrendDataPoint(profitTrendData, transactionDate, -transaction.amount);
                }
            });

            // Calcular lucro
            const profit = income - expenses;

            return {
                income,
                expenses,
                profit,
                rides,
                incomeExpensesData,
                expenseCategoriesData,
                weekdayPerformanceData,
                profitTrendData,
                hasData: periodTransactions.length > 0,
                hasExpenses: expenses > 0
            };
        }

        // Inicializar dados para o gráfico de ganhos vs despesas
        function initIncomeExpensesData(period, startDate) {
            const now = new Date();
            let labels = [];
            let income = [];
            let expenses = [];

            switch (period) {
                case 'day':
                    // Horas do dia
                    for (let i = 0; i < 24; i += 3) {
                        labels.push(`${i}h`);
                        income.push(0);
                        expenses.push(0);
                    }
                    break;
                case 'week':
                    // Dias da semana
                    const weekdays = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'];
                    labels = [...weekdays];
                    income = Array(7).fill(0);
                    expenses = Array(7).fill(0);
                    break;
                case 'month':
                    // Semanas do mês
                    labels = ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4', 'Semana 5'];
                    income = Array(5).fill(0);
                    expenses = Array(5).fill(0);
                    break;
                case 'semester':
                    // Meses do semestre
                    const semesterStart = startDate.getMonth();
                    for (let i = 0; i < 6; i++) {
                        const monthIndex = (semesterStart + i) % 12;
                        labels.push(getMonthName(monthIndex));
                        income.push(0);
                        expenses.push(0);
                    }
                    break;
                case 'year':
                    // Meses do ano
                    for (let i = 0; i < 12; i++) {
                        labels.push(getMonthName(i));
                        income.push(0);
                        expenses.push(0);
                    }
                    break;
            }

            return {
                labels,
                income,
                expenses
            };
        }

        // Inicializar dados para o gráfico de tendência de lucro
        function initProfitTrendData(period, startDate) {
            const now = new Date();
            let labels = [];
            let data = [];

            switch (period) {
                case 'day':
                    // Horas do dia
                    for (let i = 0; i < 24; i += 2) {
                        labels.push(`${i}h`);
                        data.push(0);
                    }
                    break;
                case 'week':
                    // Dias da semana
                    const weekdays = ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'];
                    labels = [...weekdays];
                    data = Array(7).fill(0);
                    break;
                case 'month':
                    // Dias do mês (agrupados por 5)
                    const daysInMonth = new Date(now.getFullYear(), now.getMonth() + 1, 0).getDate();
                    for (let i = 1; i <= daysInMonth; i += 5) {
                        labels.push(`Dia ${i}`);
                        data.push(0);
                    }
                    break;
                case 'semester':
                    // Meses do semestre
                    const semesterStart = startDate.getMonth();
                    for (let i = 0; i < 6; i++) {
                        const monthIndex = (semesterStart + i) % 12;
                        labels.push(getMonthName(monthIndex));
                        data.push(0);
                    }
                    break;
                case 'year':
                    // Meses do ano
                    for (let i = 0; i < 12; i++) {
                        labels.push(getMonthName(i));
                        data.push(0);
                    }
                    break;
            }

            return {
                labels,
                data
            };
        }

        // Atualizar ponto de dados no gráfico de ganhos vs despesas
        function updateIncomeExpensesDataPoint(data, date, incomeAmount, expenseAmount) {
            const now = new Date();
            const period = currentPeriod;
            let index = 0;

            switch (period) {
                case 'day':
                    // Horas do dia (agrupadas de 3 em 3)
                    index = Math.floor(date.getHours() / 3);
                    break;
                case 'week':
                    // Dias da semana
                    index = date.getDay() || 7; // Converter 0 (domingo) para 7
                    index -= 1; // Ajustar para índice 0-6
                    break;
                case 'month':
                    // Semanas do mês
                    const dayOfMonth = date.getDate();
                    index = Math.floor((dayOfMonth - 1) / 7);
                    break;
                case 'semester':
                    // Meses do semestre
                    const semesterStart = now.getMonth() < 6 ? 0 : 6;
                    index = date.getMonth() - semesterStart;
                    if (index < 0) index += 12;
                    break;
                case 'year':
                    // Meses do ano
                    index = date.getMonth();
                    break;
            }

            if (index >= 0 && index < data.income.length) {
                data.income[index] += incomeAmount;
                data.expenses[index] += expenseAmount;
            }
        }

        // Atualizar ponto de dados no gráfico de tendência de lucro
        function updateProfitTrendDataPoint(data, date, amount) {
            const now = new Date();
            const period = currentPeriod;
            let index = 0;

            switch (period) {
                case 'day':
                    // Horas do dia (agrupadas de 2 em 2)
                    index = Math.floor(date.getHours() / 2);
                    break;
                case 'week':
                    // Dias da semana
                    index = date.getDay() || 7; // Converter 0 (domingo) para 7
                    index -= 1; // Ajustar para índice 0-6
                    break;
                case 'month':
                    // Dias do mês (agrupados por 5)
                    index = Math.floor((date.getDate() - 1) / 5);
                    break;
                case 'semester':
                    // Meses do semestre
                    const semesterStart = now.getMonth() < 6 ? 0 : 6;
                    index = date.getMonth() - semesterStart;
                    if (index < 0) index += 12;
                    break;
                case 'year':
                    // Meses do ano
                    index = date.getMonth();
                    break;
            }

            if (index >= 0 && index < data.data.length) {
                data.data[index] += amount;
            }
        }

        // Atualizar comparações com períodos anteriores
        function updateComparisons(data) {
            // Implementação simplificada - em um sistema real, seria necessário
            // calcular os dados do período anterior para fazer comparações reais
            const incomeComparison = document.getElementById('incomeComparison');
            const expensesComparison = document.getElementById('expensesComparison');
            const profitComparison = document.getElementById('profitComparison');
            const ridesComparison = document.getElementById('ridesComparison');

            if (!data.hasData) {
                incomeComparison.innerHTML = '<span>Sem dados anteriores</span>';
                expensesComparison.innerHTML = '<span>Sem dados anteriores</span>';
                profitComparison.innerHTML = '<span>Sem dados anteriores</span>';
                ridesComparison.innerHTML = '<span>Sem dados anteriores</span>';
                return;
            }

            // Simulação de comparações
            incomeComparison.innerHTML = `
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
                </svg>
                <span>Novo valor</span>
            `;

            expensesComparison.innerHTML = `
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                </svg>
                <span>Novo valor</span>
            `;

            profitComparison.innerHTML = `
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
                </svg>
                <span>Novo valor</span>
            `;

            ridesComparison.innerHTML = `
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
                </svg>
                <span>Novo valor</span>
            `;
        }

        // Mostrar/ocultar estados vazios
        function toggleEmptyStates(data) {
            // Gráfico de ganhos vs despesas
            document.getElementById('incomeExpensesChart').style.display = data.hasData ? 'block' : 'none';
            document.getElementById('incomeExpensesEmptyState').style.display = data.hasData ? 'none' : 'flex';

            // Gráfico de categorias de despesas
            document.getElementById('expenseCategoriesChart').style.display = data.hasExpenses ? 'block' : 'none';
            document.getElementById('expenseCategoriesEmptyState').style.display = data.hasExpenses ? 'none' : 'flex';

            // Gráfico de desempenho por dia da semana
            document.getElementById('weekdayPerformanceChart').style.display = data.hasData ? 'block' : 'none';
            document.getElementById('weekdayPerformanceEmptyState').style.display = data.hasData ? 'none' : 'flex';

            // Gráfico de tendência de lucro
            document.getElementById('profitTrendChart').style.display = data.hasData ? 'block' : 'none';
            document.getElementById('profitTrendEmptyState').style.display = data.hasData ? 'none' : 'flex';

            // Tabela de transações
            document.getElementById('emptyTransactionsMessage').style.display = transactions.length > 0 ? 'none' : 'block';
        }

        // Atualizar gráfico de Ganhos vs Despesas
        function updateIncomeExpensesChart(data) {
            charts.incomeExpenses.data.labels = data.labels;
            charts.incomeExpenses.data.datasets[0].data = data.income;
            charts.incomeExpenses.data.datasets[1].data = data.expenses;
            charts.incomeExpenses.update();
        }

        // Atualizar gráfico de Categorias de Despesas
        function updateExpenseCategoriesChart(data) {
            charts.expenseCategories.data.labels = data.labels;
            charts.expenseCategories.data.datasets[0].data = data.data;
            charts.expenseCategories.update();
        }

        // Atualizar gráfico de Desempenho por Dia da Semana
        function updateWeekdayPerformanceChart(data) {
            charts.weekdayPerformance.data.labels = data.labels;
            charts.weekdayPerformance.data.datasets[0].data = data.data;
            charts.weekdayPerformance.update();
        }

        // Atualizar gráfico de Tendência de Lucro
        function updateProfitTrendChart(data) {
            charts.profitTrend.data.labels = data.labels;
            charts.profitTrend.data.datasets[0].data = data.data;
            charts.profitTrend.update();
        }

        // Abrir modal de transação
        function openTransactionModal(transaction = null) {
            const modal = document.getElementById('transactionModal');
            const modalTitle = document.getElementById('modalTitle');
            const form = document.getElementById('transactionForm');

            if (transaction) {
                modalTitle.textContent = 'Editar Lançamento';
                document.getElementById('transactionId').value = transaction.id;
                document.getElementById('transactionDate').value = transaction.date;
                document.getElementById('transactionDescription').value = transaction.description;
                document.getElementById('transactionCategory').value = transaction.category.toLowerCase();
                document.querySelector(`input[name="transactionType"][value="${transaction.type}"]`).checked = true;
                document.getElementById('transactionAmount').value = transaction.amount;
                document.getElementById('transactionRides').value = transaction.rides || 0;
                currentTransactionId = transaction.id;
            } else {
                modalTitle.textContent = 'Novo Lançamento';
                form.reset();
                document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
                currentTransactionId = null;
            }

            toggleRidesField();
            modal.classList.remove('hidden');

            // Iniciar com uma prévia
            previewDashboardUpdate();
        }

        // Fechar modal de transação
        function closeTransactionModal() {
            document.getElementById('transactionModal').classList.add('hidden');
            // Restaurar dashboard original
            updateDashboard(currentPeriod);
        }

        // Prévia da atualização do dashboard
        function previewDashboardUpdate() {
            const type = document.querySelector('input[name="transactionType"]:checked').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value) || 0;
            const rides = type === 'income' ? parseInt(document.getElementById('transactionRides').value || 0) : 0;
            const category = document.getElementById('transactionCategory').options[document.getElementById('transactionCategory').selectedIndex].text;
            const date = document.getElementById('transactionDate').value;

            // Criar uma transação temporária
            const tempTransaction = {
                id: currentTransactionId || Date.now(),
                date: date,
                description: document.getElementById('transactionDescription').value || 'Nova transação',
                category: category,
                type: type,
                amount: amount,
                rides: rides
            };

            // Criar uma cópia das transações
            let tempTransactions = [...transactions];

            // Se estiver editando, remover a transação original
            if (currentTransactionId) {
                tempTransactions = tempTransactions.filter(t => t.id !== currentTransactionId);
            }

            // Adicionar a transação temporária
            tempTransactions.push(tempTransaction);

            // Calcular dados do dashboard com a transação temporária
            const originalTransactions = transactions;
            transactions = tempTransactions;
            const data = calculateDashboardData(currentPeriod);
            transactions = originalTransactions;

            // Atualizar resumo
            document.getElementById('totalIncome').textContent = formatCurrency(data.income);
            document.getElementById('totalExpenses').textContent = formatCurrency(data.expenses);
            document.getElementById('netProfit').textContent = formatCurrency(data.profit);
            document.getElementById('totalRides').textContent = data.rides;

            // Atualizar gráficos
            updateIncomeExpensesChart(data.incomeExpensesData);
            updateExpenseCategoriesChart(data.expenseCategoriesData);
            updateWeekdayPerformanceChart(data.weekdayPerformanceData);
            updateProfitTrendChart(data.profitTrendData);

            // Mostrar/ocultar estados vazios
            toggleEmptyStates(data);
        }

        // Salvar transação
        function saveTransaction() {
            const id = currentTransactionId || Date.now();
            const date = document.getElementById('transactionDate').value;
            const description = document.getElementById('transactionDescription').value;
            const category = document.getElementById('transactionCategory').options[document.getElementById('transactionCategory').selectedIndex].text;
            const type = document.querySelector('input[name="transactionType"]:checked').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value);
            const rides = type === 'income' ? parseInt(document.getElementById('transactionRides').value || 0) : 0;

            if (!date || !description || !amount) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }

            const transaction = {
                id,
                date,
                description,
                category,
                type,
                amount,
                rides
            };

            if (currentTransactionId) {
                // Atualizar transação existente
                const index = transactions.findIndex(t => t.id === currentTransactionId);
                if (index !== -1) {
                    transactions[index] = transaction;
                }
            } else {
                // Adicionar nova transação
                transactions.unshift(transaction);
            }

            // Salvar no localStorage
            saveTransactionsToLocalStorage();

            // Atualizar tabela e dashboard
            filterTransactions();
            updateDashboard(currentPeriod);
            closeTransactionModal();
        }

        // Editar transação
        function editTransaction(id) {
            const transaction = transactions.find(t => t.id === id);
            if (transaction) {
                openTransactionModal(transaction);
            }
        }

        // Abrir modal de confirmação de exclusão
        function openDeleteConfirmModal(id) {
            currentTransactionId = id;
            document.getElementById('deleteConfirmModal').classList.remove('hidden');
        }

        // Fechar modal de confirmação de exclusão
        function closeDeleteConfirmModal() {
            document.getElementById('deleteConfirmModal').classList.add('hidden');
            currentTransactionId = null;
        }

        // Excluir transação
        function deleteTransaction() {
            if (currentTransactionId) {
                transactions = transactions.filter(t => t.id !== currentTransactionId);

                // Salvar no localStorage
                saveTransactionsToLocalStorage();

                filterTransactions();
                updateDashboard(currentPeriod);
                closeDeleteConfirmModal();
            }
        }

        // Atualizar tabela de transações com paginação
        function updateTransactionsTable() {
            const tableBody = document.getElementById('transactionsTable');
            const paginationContainer = document.getElementById('pagination');
            const paginationInfo = document.getElementById('paginationInfo');
            const emptyMessage = document.getElementById('emptyTransactionsMessage');

            tableBody.innerHTML = '';

            if (filteredTransactions.length === 0) {
                emptyMessage.classList.remove('hidden');
                paginationInfo.textContent = 'Mostrando 0 de 0 transações';
                paginationContainer.innerHTML = '';
                return;
            }

            emptyMessage.classList.add('hidden');

            // Calcular paginação
            const totalPages = Math.ceil(filteredTransactions.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, filteredTransactions.length);
            const currentTransactions = filteredTransactions.slice(startIndex, endIndex);

            // Atualizar informações de paginação
            paginationInfo.textContent = `Mostrando ${currentTransactions.length} de ${filteredTransactions.length} transações`;

            // Renderizar transações
            currentTransactions.forEach(transaction => {
                const row = document.createElement('tr');

                const dateCell = document.createElement('td');
                dateCell.className = 'py-3 px-4';
                dateCell.textContent = formatDate(transaction.date);

                const descriptionCell = document.createElement('td');
                descriptionCell.className = 'py-3 px-4';
                descriptionCell.textContent = transaction.description;

                const categoryCell = document.createElement('td');
                categoryCell.className = 'py-3 px-4';
                categoryCell.textContent = transaction.category;

                const typeCell = document.createElement('td');
                typeCell.className = 'py-3 px-4';
                const typeSpan = document.createElement('span');
                typeSpan.className = transaction.type === 'income' ? 'bg-green-900 text-green-300 py-1 px-2 rounded-full text-xs' : 'bg-red-900 text-red-300 py-1 px-2 rounded-full text-xs';
                typeSpan.textContent = transaction.type === 'income' ? 'Entrada' : 'Saída';
                typeCell.appendChild(typeSpan);

                const amountCell = document.createElement('td');
                amountCell.className = 'py-3 px-4 ' + (transaction.type === 'income' ? 'text-green-500' : 'text-red-500');
                amountCell.textContent = formatCurrency(transaction.amount);

                const ridesCell = document.createElement('td');
                ridesCell.className = 'py-3 px-4';
                ridesCell.textContent = transaction.type === 'income' ? transaction.rides : '-';

                const actionsCell = document.createElement('td');
                actionsCell.className = 'py-3 px-4';
                actionsCell.innerHTML = `
                    <div class="flex space-x-2">
                        <svg class="w-5 h-5 text-blue-500 icon-btn edit-btn" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-id="${transaction.id}">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                        </svg>
                        <svg class="w-5 h-5 text-red-500 icon-btn delete-btn" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-id="${transaction.id}">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </div>
                `;

                row.appendChild(dateCell);
                row.appendChild(descriptionCell);
                row.appendChild(categoryCell);
                row.appendChild(typeCell);
                row.appendChild(amountCell);
                row.appendChild(ridesCell);
                row.appendChild(actionsCell);

                tableBody.appendChild(row);
            });

            // Criar paginação
            createPagination(totalPages, paginationContainer);

            // Adicionar event listeners para os novos botões
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.dataset.id);
                    editTransaction(id);
                });
            });

            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.dataset.id);
                    openDeleteConfirmModal(id);
                });
            });
        }

        // Criar botões de paginação
        function createPagination(totalPages, container) {
            container.innerHTML = '';

            if (totalPages <= 1) return;

            // Botão anterior
            const prevButton = document.createElement('button');
            prevButton.className = 'w-8 h-8 flex items-center justify-center rounded bg-gray-800 text-gray-400 pagination-btn';
            prevButton.innerHTML = `
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            `;
            prevButton.disabled = currentPage === 1;
            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    updateTransactionsTable();
                }
            });
            container.appendChild(prevButton);

            // Botões de página
            const maxVisiblePages = 3;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.className = `w-8 h-8 flex items-center justify-center rounded pagination-btn ${i === currentPage ? 'active bg-red-600 text-white' : 'bg-gray-800 text-gray-400'}`;
                pageButton.textContent = i;
                pageButton.addEventListener('click', () => {
                    currentPage = i;
                    updateTransactionsTable();
                });
                container.appendChild(pageButton);
            }

            // Botão próximo
            const nextButton = document.createElement('button');
            nextButton.className = 'w-8 h-8 flex items-center justify-center rounded bg-gray-800 text-gray-400 pagination-btn';
            nextButton.innerHTML = `
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            `;
            nextButton.disabled = currentPage === totalPages;
            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    updateTransactionsTable();
                }
            });
            container.appendChild(nextButton);
        }

        // Exportar para PDF
        function exportToPdf() {
            if (transactions.length === 0) {
                alert('Não há dados para exportar. Adicione transações primeiro.');
                return;
            }

            const element = document.body;
            const opt = {
                margin: 10,
                filename: `relatorio-financeiro-${currentPeriod}.pdf`,
                image: {
                    type: 'jpeg',
                    quality: 0.98
                },
                html2canvas: {
                    scale: 2
                },
                jsPDF: {
                    unit: 'mm',
                    format: 'a4',
                    orientation: 'portrait'
                }
            };

            // Notificar o usuário
            alert('Preparando o PDF para download...');

            // Exportar
            html2pdf().set(opt).from(element).save();
        }

        // Formatar moeda
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        // Formatar data
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('pt-BR');
        }

        // Obter nome do mês
        function getMonthName(monthIndex) {
            const months = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
            return months[monthIndex];
        }
    
function generateReport() {
    // Simula o comando de impressão (Ctrl+P) para que a janela de impressão seja aberta
    window.print();
}
</script>
<script>
        (function() {
            function c() {
                var b = a.contentDocument || a.contentWindow.document;
                if (b) {
                    var d = b.createElement('script');
                    d.innerHTML = "window.__CF$cv$params={r:'946e3854028bc504',t:'MTc0ODQ0MDIxNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
                    b.getElementsByTagName('head')[0].appendChild(d)
                }
            }
            if (document.body) {
                var a = document.createElement('iframe');
                a.height = 1;
                a.width = 1;
                a.style.position = 'absolute';
                a.style.top = 0;
                a.style.left = 0;
                a.style.border = 'none';
                a.style.visibility = 'hidden';
                document.body.appendChild(a);
                if ('loading' !== document.readyState) c();
                else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c);
                else {
                    var e = document.onreadystatechange || function() {};
                    document.onreadystatechange = function(b) {
                        e(b);
                        'loading' !== document.readyState && (document.onreadystatechange = e, c())
                    }
                }
            }
        })();
    
function generateReport() {
    // Simula o comando de impressão (Ctrl+P) para que a janela de impressão seja aberta
    window.print();
}
</script>

<div class="fixed bottom-5 right-5">
<button class="netflix-btn" onclick="generateReport()">
            Gerar Relatório
        </button>
</div>

<script>
        // Função para gerar o relatório (abre a tela de impressão)
        function generateReport() {
            window.print();
        }
    
function generateReport() {
    // Simula o comando de impressão (Ctrl+P) para que a janela de impressão seja aberta
    window.print();
}
</script>
</body>
</html>