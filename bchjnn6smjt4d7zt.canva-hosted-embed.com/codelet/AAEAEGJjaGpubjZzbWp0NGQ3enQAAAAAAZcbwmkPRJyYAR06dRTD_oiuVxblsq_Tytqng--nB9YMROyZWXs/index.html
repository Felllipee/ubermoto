<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DriverFinance - Controle Financeiro para Motoristas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --netflix-red: #E50914;
            --netflix-black: #141414;
            --netflix-dark-gray: #181818;
            --netflix-light-gray: #2F2F2F;
        }

        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--netflix-black);
            color: white;
        }

        .netflix-btn {
            background-color: var(--netflix-red);
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .netflix-btn:hover {
            background-color: #f40612;
            transform: scale(1.05);
        }

        .card {
            background-color: var(--netflix-dark-gray);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            transition: transform 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .filter-btn {
            background-color: var(--netflix-light-gray);
            color: #ccc;
            border-radius: 20px;
            padding: 6px 16px;
            transition: all 0.2s ease;
        }

        .filter-btn.active {
            background-color: var(--netflix-red);
            color: white;
        }

        .filter-btn:hover:not(.active) {
            background-color: #3a3a3a;
            color: white;
        }

        .modal {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-content {
            background-color: var(--netflix-dark-gray);
            border-radius: 8px;
        }

        input,
        select {
            background-color: var(--netflix-light-gray);
            border: 1px solid #444;
            color: white;
        }

        input:focus,
        select:focus {
            border-color: var(--netflix-red);
            outline: none;
        }

        table th {
            background-color: var(--netflix-light-gray);
        }

        table tr:nth-child(even) {
            background-color: rgba(47, 47, 47, 0.5);
        }

        table tr:hover {
            background-color: rgba(229, 9, 20, 0.1);
        }

        .icon-btn {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .icon-btn:hover {
            transform: scale(1.2);
        }

        .pagination-btn {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .pagination-btn:hover:not(.active) {
            background-color: #3a3a3a !important;
        }

        .pagination-btn.active {
            background-color: var(--netflix-red) !important;
            color: white !important;
        }

        /* Scrollbar customization */

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--netflix-black);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--netflix-light-gray);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--netflix-red);
        }
    </style>
</head>

<body class="min-h-screen">
    <header class="py-4 px-6 md:px-12 flex justify-between items-center border-b border-gray-800">
        <div class="flex items-center">
            <svg class="w-8 h-8 text-red-600 mr-2" fill="currentColor" viewBox="0 0 20 20">
                <path d="M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM14 11a1 1 0 011 1v1h1a1 1 0 110 2h-1v1a1 1 0 11-2 0v-1h-1a1 1 0 110-2h1v-1a1 1 0 011-1z"></path>
            </svg>
            <h1 class="text-2xl font-bold">DriverFinance</h1>
        </div>
        <div class="flex items-center">
            <div class="mr-4 hidden md:block">
                <span class="text-gray-400">Olá, </span>
                <span class="font-medium">Motorista</span>
            </div>
            <button class="netflix-btn flex items-center" id="addTransactionBtn">
                <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                </svg>
                Novo Lançamento
            </button>
        </div>
    </header>

    <main class="py-6 px-6 md:px-12">
        <!-- Filtros -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold mb-4">Período</h2>
            <div class="flex flex-wrap gap-2">
                <button class="filter-btn" data-period="day">Dia</button>
                <button class="filter-btn" data-period="week">Semana</button>
                <button class="filter-btn active" data-period="month">Mês</button>
                <button class="filter-btn" data-period="semester">Semestre</button>
                <button class="filter-btn" data-period="year">Ano</button>
            </div>
        </div>

        <!-- Resumo -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="card p-6">
                <h3 class="text-gray-400 mb-1">Receita Total</h3>
                <div class="text-2xl font-bold" id="totalIncome">R$ 3.250,00</div>
                <div class="text-green-500 text-sm mt-2 flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
                    </svg>
                    <span>12% vs. período anterior</span>
                </div>
            </div>

            <div class="card p-6">
                <h3 class="text-gray-400 mb-1">Despesas</h3>
                <div class="text-2xl font-bold" id="totalExpenses">R$ 1.850,00</div>
                <div class="text-red-500 text-sm mt-2 flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
                    </svg>
                    <span>8% vs. período anterior</span>
                </div>
            </div>

            <div class="card p-6">
                <h3 class="text-gray-400 mb-1">Lucro Líquido</h3>
                <div class="text-2xl font-bold" id="netProfit">R$ 1.400,00</div>
                <div class="text-green-500 text-sm mt-2 flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
                    </svg>
                    <span>15% vs. período anterior</span>
                </div>
            </div>

            <div class="card p-6">
                <h3 class="text-gray-400 mb-1">Corridas</h3>
                <div class="text-2xl font-bold" id="totalRides">142</div>
                <div class="text-green-500 text-sm mt-2 flex items-center">
                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
                    </svg>
                    <span>5% vs. período anterior</span>
                </div>
            </div>
        </div>

        <!-- Gráficos -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div class="card p-6">
                <h3 class="text-lg font-semibold mb-4">Receitas vs Despesas</h3>
                <div class="h-64">
                    <canvas id="incomeExpensesChart"></canvas>
                </div>
            </div>

            <div class="card p-6">
                <h3 class="text-lg font-semibold mb-4">Categorias de Despesas</h3>
                <div class="h-64">
                    <canvas id="expenseCategoriesChart"></canvas>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            <div class="card p-6">
                <h3 class="text-lg font-semibold mb-4">Desempenho por Dia da Semana</h3>
                <div class="h-64">
                    <canvas id="weekdayPerformanceChart"></canvas>
                </div>
            </div>

            <div class="card p-6">
                <h3 class="text-lg font-semibold mb-4">Lucro Líquido (Tendência)</h3>
                <div class="h-64">
                    <canvas id="profitTrendChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Tabela de Transações -->
        <div class="card p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Últimas Transações</h3>
                <div class="relative">
                    <input type="text" id="searchInput" placeholder="Buscar transação..." class="py-2 px-4 rounded-full text-sm w-full md:w-64">
                    <svg class="w-5 h-5 text-gray-400 absolute right-3 top-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead>
                        <tr class="text-gray-400">
                            <th class="py-3 px-4 rounded-tl-lg">Data</th>
                            <th class="py-3 px-4">Descrição</th>
                            <th class="py-3 px-4">Categoria</th>
                            <th class="py-3 px-4">Tipo</th>
                            <th class="py-3 px-4">Valor</th>
                            <th class="py-3 px-4">Corridas</th>
                            <th class="py-3 px-4 rounded-tr-lg">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="transactionsTable">
                        <!-- Dados serão inseridos via JavaScript -->
                    </tbody>
                </table>
            </div>
            <div class="mt-4 flex justify-between items-center">
                <div class="text-sm text-gray-400" id="paginationInfo">Mostrando 0 de 0 transações</div>
                <div class="flex space-x-1" id="pagination">
                    <!-- Paginação será inserida via JavaScript -->
                </div>
            </div>
        </div>
    </main>

    <footer class="py-6 px-6 md:px-12 border-t border-gray-800">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <div class="mb-4 md:mb-0">
                <p class="text-gray-400">© 2023 DriverFinance - Controle Financeiro para Motoristas</p>
            </div>
            <div class="flex space-x-4">
                <button class="netflix-btn flex items-center" id="exportPdfBtn">
                    <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Exportar PDF
                </button>
            </div>
        </div>
    </footer>

    <!-- Modal de Novo Lançamento -->
    <div id="transactionModal" class="fixed inset-0 z-50 hidden modal flex items-center justify-center p-4">
        <div class="modal-content w-full max-w-md p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold" id="modalTitle">Novo Lançamento</h3>
                <button id="closeModalBtn" class="text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <form id="transactionForm">
                <input type="hidden" id="transactionId">
                <div class="mb-4">
                    <label class="block text-gray-400 mb-2" for="transactionDate">Data</label>
                    <input type="date" id="transactionDate" class="w-full p-2 rounded">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-400 mb-2" for="transactionDescription">Descrição</label>
                    <input type="text" id="transactionDescription" class="w-full p-2 rounded" placeholder="Ex: Uber - Corridas">
                </div>
                <div class="mb-4">
                    <label class="block text-gray-400 mb-2" for="transactionCategory">Categoria</label>
                    <select id="transactionCategory" class="w-full p-2 rounded">
                        <option value="receita">Receita</option>
                        <option value="combustivel">Combustível</option>
                        <option value="manutencao">Manutenção</option>
                        <option value="lavagem">Lavagem</option>
                        <option value="alimentacao">Alimentação</option>
                        <option value="taxas">Taxas e Impostos</option>
                        <option value="outros">Outros</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-400 mb-2" for="transactionType">Tipo</label>
                    <div class="flex space-x-4">
                        <label class="flex items-center">
                            <input type="radio" name="transactionType" value="income" class="mr-2" checked id="incomeType">
                            <span>Entrada</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="transactionType" value="expense" class="mr-2" id="expenseType">
                            <span>Saída</span>
                        </label>
                    </div>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-400 mb-2" for="transactionAmount">Valor (R$)</label>
                    <input type="number" id="transactionAmount" class="w-full p-2 rounded" step="0.01" min="0" placeholder="0,00">
                </div>
                <div class="mb-6" id="ridesCountContainer">
                    <label class="block text-gray-400 mb-2" for="transactionRides">Número de Corridas</label>
                    <input type="number" id="transactionRides" class="w-full p-2 rounded" min="0" placeholder="0">
                </div>
                <div class="flex justify-end">
                    <button type="button" id="cancelTransactionBtn" class="bg-gray-700 text-white py-2 px-4 rounded mr-2 hover:bg-gray-600">Cancelar</button>
                    <button type="submit" class="netflix-btn">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Confirmação de Exclusão -->
    <div id="deleteConfirmModal" class="fixed inset-0 z-50 hidden modal flex items-center justify-center p-4">
        <div class="modal-content w-full max-w-sm p-6">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-semibold">Confirmar Exclusão</h3>
                <button id="closeDeleteModalBtn" class="text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <p class="mb-6">Tem certeza que deseja excluir esta transação? Esta ação não pode ser desfeita.</p>
            <div class="flex justify-end">
                <button type="button" id="cancelDeleteBtn" class="bg-gray-700 text-white py-2 px-4 rounded mr-2 hover:bg-gray-600">Cancelar</button>
                <button type="button" id="confirmDeleteBtn" class="bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700">Excluir</button>
            </div>
        </div>
    </div>

    <script>
        // Dados de exemplo
        let sampleData = {
            day: {
                income: 320,
                expenses: 200,
                profit: 120,
                rides: 12,
                incomeExpensesData: {
                    labels: ['Hoje'],
                    income: [320],
                    expenses: [200]
                },
                expenseCategoriesData: {
                    labels: ['Combustível', 'Alimentação', 'Outros'],
                    data: [150, 30, 20]
                },
                weekdayPerformanceData: {
                    labels: ['Hoje'],
                    data: [120]
                },
                profitTrendData: {
                    labels: ['8h', '10h', '12h', '14h', '16h', '18h', 'Agora'],
                    data: [20, 35, 45, 60, 80, 95, 120]
                }
            },
            week: {
                income: 1850,
                expenses: 950,
                profit: 900,
                rides: 65,
                incomeExpensesData: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    income: [280, 290, 320, 310, 350, 180, 120],
                    expenses: [150, 120, 200, 130, 180, 100, 70]
                },
                expenseCategoriesData: {
                    labels: ['Combustível', 'Manutenção', 'Alimentação', 'Lavagem', 'Outros'],
                    data: [500, 150, 180, 60, 60]
                },
                weekdayPerformanceData: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    data: [130, 170, 120, 180, 170, 80, 50]
                },
                profitTrendData: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    data: [130, 170, 120, 180, 170, 80, 50]
                }
            },
            month: {
                income: 3250,
                expenses: 1850,
                profit: 1400,
                rides: 142,
                incomeExpensesData: {
                    labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4'],
                    income: [750, 820, 880, 800],
                    expenses: [450, 480, 520, 400]
                },
                expenseCategoriesData: {
                    labels: ['Combustível', 'Manutenção', 'Alimentação', 'Lavagem', 'Taxas', 'Outros'],
                    data: [900, 350, 250, 120, 150, 80]
                },
                weekdayPerformanceData: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    data: [180, 220, 200, 240, 260, 160, 140]
                },
                profitTrendData: {
                    labels: ['Semana 1', 'Semana 2', 'Semana 3', 'Semana 4'],
                    data: [300, 340, 360, 400]
                }
            },
            semester: {
                income: 18500,
                expenses: 9800,
                profit: 8700,
                rides: 820,
                incomeExpensesData: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    income: [2800, 3100, 3200, 3000, 3150, 3250],
                    expenses: [1500, 1650, 1700, 1600, 1500, 1850]
                },
                expenseCategoriesData: {
                    labels: ['Combustível', 'Manutenção', 'Alimentação', 'Lavagem', 'Taxas', 'Outros'],
                    data: [4800, 1800, 1200, 600, 800, 600]
                },
                weekdayPerformanceData: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    data: [1300, 1400, 1350, 1450, 1500, 1000, 700]
                },
                profitTrendData: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                    data: [1300, 1450, 1500, 1400, 1650, 1400]
                }
            },
            year: {
                income: 38200,
                expenses: 19500,
                profit: 18700,
                rides: 1680,
                incomeExpensesData: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                    income: [2800, 3100, 3200, 3000, 3150, 3250, 3300, 3400, 3200, 3300, 3250, 3250],
                    expenses: [1500, 1650, 1700, 1600, 1500, 1850, 1700, 1600, 1650, 1700, 1550, 1500]
                },
                expenseCategoriesData: {
                    labels: ['Combustível', 'Manutenção', 'Alimentação', 'Lavagem', 'Taxas', 'Outros'],
                    data: [9500, 3800, 2400, 1200, 1600, 1000]
                },
                weekdayPerformanceData: {
                    labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb', 'Dom'],
                    data: [2800, 2900, 2750, 3000, 3100, 2200, 1950]
                },
                profitTrendData: {
                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                    data: [1300, 1450, 1500, 1400, 1650, 1400, 1600, 1800, 1550, 1600, 1700, 1750]
                }
            }
        };

        // Variáveis globais
        let currentPeriod = 'month';
        let charts = {};
        let currentTransactionId = null;
        let transactions = [{
                id: 1,
                date: '2023-06-15',
                description: 'Uber - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 320,
                rides: 12
            },
            {
                id: 2,
                date: '2023-06-14',
                description: '99 - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 280,
                rides: 10
            },
            {
                id: 3,
                date: '2023-06-14',
                description: 'Combustível',
                category: 'Combustível',
                type: 'expense',
                amount: 200,
                rides: 0
            },
            {
                id: 4,
                date: '2023-06-13',
                description: 'Manutenção - Troca de óleo',
                category: 'Manutenção',
                type: 'expense',
                amount: 150,
                rides: 0
            },
            {
                id: 5,
                date: '2023-06-12',
                description: 'Uber - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 290,
                rides: 11
            },
            {
                id: 6,
                date: '2023-06-11',
                description: 'Lavagem do carro',
                category: 'Lavagem',
                type: 'expense',
                amount: 50,
                rides: 0
            },
            {
                id: 7,
                date: '2023-06-10',
                description: '99 - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 310,
                rides: 13
            },
            {
                id: 8,
                date: '2023-06-09',
                description: 'Combustível',
                category: 'Combustível',
                type: 'expense',
                amount: 180,
                rides: 0
            },
            {
                id: 9,
                date: '2023-06-08',
                description: 'Uber - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 270,
                rides: 9
            },
            {
                id: 10,
                date: '2023-06-07',
                description: 'Alimentação',
                category: 'Alimentação',
                type: 'expense',
                amount: 45,
                rides: 0
            },
            {
                id: 11,
                date: '2023-06-06',
                description: 'Uber - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 300,
                rides: 12
            },
            {
                id: 12,
                date: '2023-06-05',
                description: 'Combustível',
                category: 'Combustível',
                type: 'expense',
                amount: 190,
                rides: 0
            },
            {
                id: 13,
                date: '2023-06-04',
                description: '99 - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 260,
                rides: 10
            },
            {
                id: 14,
                date: '2023-06-03',
                description: 'Manutenção - Filtro de ar',
                category: 'Manutenção',
                type: 'expense',
                amount: 80,
                rides: 0
            },
            {
                id: 15,
                date: '2023-06-02',
                description: 'Uber - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 330,
                rides: 14
            },
            {
                id: 16,
                date: '2023-06-01',
                description: 'Combustível',
                category: 'Combustível',
                type: 'expense',
                amount: 210,
                rides: 0
            },
            {
                id: 17,
                date: '2023-05-31',
                description: '99 - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 290,
                rides: 11
            },
            {
                id: 18,
                date: '2023-05-30',
                description: 'Alimentação',
                category: 'Alimentação',
                type: 'expense',
                amount: 35,
                rides: 0
            },
            {
                id: 19,
                date: '2023-05-29',
                description: 'Uber - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 310,
                rides: 13
            },
            {
                id: 20,
                date: '2023-05-28',
                description: 'Combustível',
                category: 'Combustível',
                type: 'expense',
                amount: 195,
                rides: 0
            },
            {
                id: 21,
                date: '2023-05-27',
                description: '99 - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 280,
                rides: 10
            },
            {
                id: 22,
                date: '2023-05-26',
                description: 'Lavagem do carro',
                category: 'Lavagem',
                type: 'expense',
                amount: 50,
                rides: 0
            },
            {
                id: 23,
                date: '2023-05-25',
                description: 'Uber - Corridas',
                category: 'Receita',
                type: 'income',
                amount: 300,
                rides: 12
            },
            {
                id: 24,
                date: '2023-05-24',
                description: 'Combustível',
                category: 'Combustível',
                type: 'expense',
                amount: 205,
                rides: 0
            }
        ];

        // Variáveis de paginação e busca
        let currentPage = 1;
        const itemsPerPage = 5;
        let filteredTransactions = [];
        let searchTerm = '';

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            updateDashboard(currentPeriod);
            setupEventListeners();
            toggleRidesField();

            // Inicializar a tabela de transações com paginação
            filteredTransactions = [...transactions];
            updateTransactionsTable();

            // Adicionar event listeners para atualização em tempo real
            document.getElementById('transactionAmount').addEventListener('input', previewDashboardUpdate);
            document.getElementById('transactionRides').addEventListener('input', previewDashboardUpdate);
            document.getElementById('incomeType').addEventListener('change', previewDashboardUpdate);
            document.getElementById('expenseType').addEventListener('change', previewDashboardUpdate);
            document.getElementById('transactionCategory').addEventListener('change', previewDashboardUpdate);
        });

        // Inicializar gráficos
        function initCharts() {
            // Gráfico de Receitas vs Despesas
            charts.incomeExpenses = new Chart(
                document.getElementById('incomeExpensesChart'), {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                                label: 'Receitas',
                                backgroundColor: 'rgba(16, 185, 129, 0.8)',
                                borderColor: 'rgb(16, 185, 129)',
                                borderWidth: 1,
                                data: []
                            },
                            {
                                label: 'Despesas',
                                backgroundColor: 'rgba(239, 68, 68, 0.8)',
                                borderColor: 'rgb(239, 68, 68)',
                                borderWidth: 1,
                                data: []
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    color: 'white'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                }
            );

            // Gráfico de Categorias de Despesas
            charts.expenseCategories = new Chart(
                document.getElementById('expenseCategoriesChart'), {
                    type: 'doughnut',
                    data: {
                        labels: [],
                        datasets: [{
                            data: [],
                            backgroundColor: [
                                'rgba(239, 68, 68, 0.8)',
                                'rgba(245, 158, 11, 0.8)',
                                'rgba(16, 185, 129, 0.8)',
                                'rgba(59, 130, 246, 0.8)',
                                'rgba(139, 92, 246, 0.8)',
                                'rgba(236, 72, 153, 0.8)'
                            ],
                            borderColor: [
                                'rgb(239, 68, 68)',
                                'rgb(245, 158, 11)',
                                'rgb(16, 185, 129)',
                                'rgb(59, 130, 246)',
                                'rgb(139, 92, 246)',
                                'rgb(236, 72, 153)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'right',
                                labels: {
                                    color: 'white'
                                }
                            }
                        }
                    }
                }
            );

            // Gráfico de Desempenho por Dia da Semana
            charts.weekdayPerformance = new Chart(
                document.getElementById('weekdayPerformanceChart'), {
                    type: 'bar',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Lucro Líquido',
                            backgroundColor: 'rgba(99, 102, 241, 0.8)',
                            borderColor: 'rgb(99, 102, 241)',
                            borderWidth: 1,
                            data: []
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    color: 'white'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                }
            );

            // Gráfico de Tendência de Lucro
            charts.profitTrend = new Chart(
                document.getElementById('profitTrendChart'), {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Lucro Líquido',
                            backgroundColor: 'rgba(16, 185, 129, 0.2)',
                            borderColor: 'rgb(16, 185, 129)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgb(16, 185, 129)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(16, 185, 129)',
                            fill: true,
                            tension: 0.4,
                            data: []
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                                labels: {
                                    color: 'white'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: 'rgba(255, 255, 255, 0.7)'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                }
            );
        }

        // Configurar event listeners
        function setupEventListeners() {
            // Filtros de período
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentPeriod = this.dataset.period;
                    updateDashboard(currentPeriod);
                });
            });

            // Botão de novo lançamento
            document.getElementById('addTransactionBtn').addEventListener('click', function() {
                openTransactionModal();
            });

            // Fechar modal
            document.getElementById('closeModalBtn').addEventListener('click', function() {
                closeTransactionModal();
            });

            document.getElementById('cancelTransactionBtn').addEventListener('click', function() {
                closeTransactionModal();
            });

            // Formulário de transação
            document.getElementById('transactionForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveTransaction();
            });

            // Modal de confirmação de exclusão
            document.getElementById('closeDeleteModalBtn').addEventListener('click', function() {
                closeDeleteConfirmModal();
            });

            document.getElementById('cancelDeleteBtn').addEventListener('click', function() {
                closeDeleteConfirmModal();
            });

            document.getElementById('confirmDeleteBtn').addEventListener('click', function() {
                deleteTransaction();
            });

            // Exportar PDF
            document.getElementById('exportPdfBtn').addEventListener('click', function() {
                exportToPdf();
            });

            // Mostrar/ocultar campo de corridas com base no tipo de transação
            document.getElementById('incomeType').addEventListener('change', toggleRidesField);
            document.getElementById('expenseType').addEventListener('change', toggleRidesField);

            // Campo de busca
            document.getElementById('searchInput').addEventListener('input', function(e) {
                searchTerm = e.target.value.toLowerCase();
                currentPage = 1; // Resetar para a primeira página ao buscar
                filterTransactions();
            });
        }

        // Filtrar transações com base no termo de busca
        function filterTransactions() {
            if (!searchTerm) {
                filteredTransactions = [...transactions];
            } else {
                filteredTransactions = transactions.filter(transaction => {
                    const date = formatDate(transaction.date).toLowerCase();
                    const description = transaction.description.toLowerCase();
                    const category = transaction.category.toLowerCase();
                    const type = transaction.type === 'income' ? 'entrada' : 'saída';
                    const amount = transaction.amount.toString();
                    const rides = transaction.rides.toString();

                    return date.includes(searchTerm) ||
                        description.includes(searchTerm) ||
                        category.includes(searchTerm) ||
                        type.includes(searchTerm) ||
                        amount.includes(searchTerm) ||
                        rides.includes(searchTerm);
                });
            }

            updateTransactionsTable();
        }

        // Mostrar/ocultar campo de corridas com base no tipo de transação
        function toggleRidesField() {
            const ridesContainer = document.getElementById('ridesCountContainer');
            const isIncome = document.getElementById('incomeType').checked;

            if (isIncome) {
                ridesContainer.style.display = 'block';
            } else {
                ridesContainer.style.display = 'none';
                document.getElementById('transactionRides').value = 0;
            }
        }

        // Atualizar dashboard com base no período selecionado
        function updateDashboard(period) {
            const data = sampleData[period];

            // Atualizar resumo
            document.getElementById('totalIncome').textContent = formatCurrency(data.income);
            document.getElementById('totalExpenses').textContent = formatCurrency(data.expenses);
            document.getElementById('netProfit').textContent = formatCurrency(data.profit);
            document.getElementById('totalRides').textContent = data.rides;

            // Atualizar gráficos
            updateIncomeExpensesChart(data.incomeExpensesData);
            updateExpenseCategoriesChart(data.expenseCategoriesData);
            updateWeekdayPerformanceChart(data.weekdayPerformanceData);
            updateProfitTrendChart(data.profitTrendData);
        }

        // Atualizar gráfico de Receitas vs Despesas
        function updateIncomeExpensesChart(data) {
            charts.incomeExpenses.data.labels = data.labels;
            charts.incomeExpenses.data.datasets[0].data = data.income;
            charts.incomeExpenses.data.datasets[1].data = data.expenses;
            charts.incomeExpenses.update();
        }

        // Atualizar gráfico de Categorias de Despesas
        function updateExpenseCategoriesChart(data) {
            charts.expenseCategories.data.labels = data.labels;
            charts.expenseCategories.data.datasets[0].data = data.data;
            charts.expenseCategories.update();
        }

        // Atualizar gráfico de Desempenho por Dia da Semana
        function updateWeekdayPerformanceChart(data) {
            charts.weekdayPerformance.data.labels = data.labels;
            charts.weekdayPerformance.data.datasets[0].data = data.data;
            charts.weekdayPerformance.update();
        }

        // Atualizar gráfico de Tendência de Lucro
        function updateProfitTrendChart(data) {
            charts.profitTrend.data.labels = data.labels;
            charts.profitTrend.data.datasets[0].data = data.data;
            charts.profitTrend.update();
        }

        // Abrir modal de transação
        function openTransactionModal(transaction = null) {
            const modal = document.getElementById('transactionModal');
            const modalTitle = document.getElementById('modalTitle');
            const form = document.getElementById('transactionForm');

            if (transaction) {
                modalTitle.textContent = 'Editar Lançamento';
                document.getElementById('transactionId').value = transaction.id;
                document.getElementById('transactionDate').value = transaction.date;
                document.getElementById('transactionDescription').value = transaction.description;
                document.getElementById('transactionCategory').value = transaction.category.toLowerCase();
                document.querySelector(`input[name="transactionType"][value="${transaction.type}"]`).checked = true;
                document.getElementById('transactionAmount').value = transaction.amount;
                document.getElementById('transactionRides').value = transaction.rides || 0;
                currentTransactionId = transaction.id;
            } else {
                modalTitle.textContent = 'Novo Lançamento';
                form.reset();
                document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
                currentTransactionId = null;
            }

            toggleRidesField();
            modal.classList.remove('hidden');

            // Iniciar com uma prévia
            previewDashboardUpdate();
        }

        // Fechar modal de transação
        function closeTransactionModal() {
            document.getElementById('transactionModal').classList.add('hidden');
            // Restaurar dashboard original
            updateDashboard(currentPeriod);
        }

        // Prévia da atualização do dashboard
        function previewDashboardUpdate() {
            const type = document.querySelector('input[name="transactionType"]:checked').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value) || 0;
            const rides = type === 'income' ? parseInt(document.getElementById('transactionRides').value || 0) : 0;
            const category = document.getElementById('transactionCategory').options[document.getElementById('transactionCategory').selectedIndex].text;

            // Criar uma cópia dos dados atuais
            const previewData = JSON.parse(JSON.stringify(sampleData));

            // Atualizar os valores com base na transação atual
            for (const period in previewData) {
                if (type === 'income') {
                    previewData[period].income += amount;
                    previewData[period].profit += amount;
                    previewData[period].rides += rides;

                    // Atualizar o último valor no gráfico de receitas
                    const lastIndex = previewData[period].incomeExpensesData.income.length - 1;
                    previewData[period].incomeExpensesData.income[lastIndex] += amount;

                    // Atualizar o último valor no gráfico de lucro
                    const lastProfitIndex = previewData[period].profitTrendData.data.length - 1;
                    previewData[period].profitTrendData.data[lastProfitIndex] += amount;

                    // Atualizar o último valor no gráfico de desempenho por dia
                    const lastWeekdayIndex = previewData[period].weekdayPerformanceData.data.length - 1;
                    previewData[period].weekdayPerformanceData.data[lastWeekdayIndex] += amount;
                } else {
                    previewData[period].expenses += amount;
                    previewData[period].profit -= amount;

                    // Atualizar o último valor no gráfico de despesas
                    const lastIndex = previewData[period].incomeExpensesData.expenses.length - 1;
                    previewData[period].incomeExpensesData.expenses[lastIndex] += amount;

                    // Atualizar o último valor no gráfico de lucro
                    const lastProfitIndex = previewData[period].profitTrendData.data.length - 1;
                    previewData[period].profitTrendData.data[lastProfitIndex] -= amount;

                    // Atualizar o último valor no gráfico de desempenho por dia
                    const lastWeekdayIndex = previewData[period].weekdayPerformanceData.data.length - 1;
                    previewData[period].weekdayPerformanceData.data[lastWeekdayIndex] -= amount;

                    // Atualizar categorias de despesas
                    if (amount > 0) {
                        const categoryIndex = previewData[period].expenseCategoriesData.labels.indexOf(category);
                        if (categoryIndex !== -1) {
                            previewData[period].expenseCategoriesData.data[categoryIndex] += amount;
                        } else {
                            previewData[period].expenseCategoriesData.labels.push(category);
                            previewData[period].expenseCategoriesData.data.push(amount);
                        }
                    }
                }
            }

            // Atualizar o dashboard com os dados de prévia
            const data = previewData[currentPeriod];

            // Atualizar resumo
            document.getElementById('totalIncome').textContent = formatCurrency(data.income);
            document.getElementById('totalExpenses').textContent = formatCurrency(data.expenses);
            document.getElementById('netProfit').textContent = formatCurrency(data.profit);
            document.getElementById('totalRides').textContent = data.rides;

            // Atualizar gráficos
            updateIncomeExpensesChart(data.incomeExpensesData);
            updateExpenseCategoriesChart(data.expenseCategoriesData);
            updateWeekdayPerformanceChart(data.weekdayPerformanceData);
            updateProfitTrendChart(data.profitTrendData);
        }

        // Salvar transação
        function saveTransaction() {
            const id = currentTransactionId || Date.now();
            const date = document.getElementById('transactionDate').value;
            const description = document.getElementById('transactionDescription').value;
            const category = document.getElementById('transactionCategory').options[document.getElementById('transactionCategory').selectedIndex].text;
            const type = document.querySelector('input[name="transactionType"]:checked').value;
            const amount = parseFloat(document.getElementById('transactionAmount').value);
            const rides = type === 'income' ? parseInt(document.getElementById('transactionRides').value || 0) : 0;

            if (!date || !description || !amount) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }

            const transaction = {
                id,
                date,
                description,
                category,
                type,
                amount,
                rides
            };

            if (currentTransactionId) {
                // Atualizar transação existente
                const index = transactions.findIndex(t => t.id === currentTransactionId);
                if (index !== -1) {
                    transactions[index] = transaction;
                }
            } else {
                // Adicionar nova transação
                transactions.unshift(transaction);
            }

            // Atualizar os dados do dashboard com base na nova transação
            updateDashboardData(transaction);

            // Atualizar tabela e dashboard
            filterTransactions();
            updateDashboard(currentPeriod);
            closeTransactionModal();
        }

        // Atualizar os dados do dashboard com base na nova transação
        function updateDashboardData(transaction) {
            for (const period in sampleData) {
                if (transaction.type === 'income') {
                    sampleData[period].income += transaction.amount;
                    sampleData[period].profit += transaction.amount;
                    sampleData[period].rides += transaction.rides;

                    // Atualizar o último valor no gráfico de receitas
                    const lastIndex = sampleData[period].incomeExpensesData.income.length - 1;
                    sampleData[period].incomeExpensesData.income[lastIndex] += transaction.amount;

                    // Atualizar o último valor no gráfico de lucro
                    const lastProfitIndex = sampleData[period].profitTrendData.data.length - 1;
                    sampleData[period].profitTrendData.data[lastProfitIndex] += transaction.amount;

                    // Atualizar o último valor no gráfico de desempenho por dia
                    const lastWeekdayIndex = sampleData[period].weekdayPerformanceData.data.length - 1;
                    sampleData[period].weekdayPerformanceData.data[lastWeekdayIndex] += transaction.amount;
                } else {
                    sampleData[period].expenses += transaction.amount;
                    sampleData[period].profit -= transaction.amount;

                    // Atualizar o último valor no gráfico de despesas
                    const lastIndex = sampleData[period].incomeExpensesData.expenses.length - 1;
                    sampleData[period].incomeExpensesData.expenses[lastIndex] += transaction.amount;

                    // Atualizar o último valor no gráfico de lucro
                    const lastProfitIndex = sampleData[period].profitTrendData.data.length - 1;
                    sampleData[period].profitTrendData.data[lastProfitIndex] -= transaction.amount;

                    // Atualizar o último valor no gráfico de desempenho por dia
                    const lastWeekdayIndex = sampleData[period].weekdayPerformanceData.data.length - 1;
                    sampleData[period].weekdayPerformanceData.data[lastWeekdayIndex] -= transaction.amount;

                    // Atualizar categorias de despesas
                    if (transaction.amount > 0) {
                        const categoryIndex = sampleData[period].expenseCategoriesData.labels.indexOf(transaction.category);
                        if (categoryIndex !== -1) {
                            sampleData[period].expenseCategoriesData.data[categoryIndex] += transaction.amount;
                        } else {
                            sampleData[period].expenseCategoriesData.labels.push(transaction.category);
                            sampleData[period].expenseCategoriesData.data.push(transaction.amount);
                        }
                    }
                }
            }
        }

        // Editar transação
        function editTransaction(id) {
            const transaction = transactions.find(t => t.id === id);
            if (transaction) {
                openTransactionModal(transaction);
            }
        }

        // Abrir modal de confirmação de exclusão
        function openDeleteConfirmModal(id) {
            currentTransactionId = id;
            document.getElementById('deleteConfirmModal').classList.remove('hidden');
        }

        // Fechar modal de confirmação de exclusão
        function closeDeleteConfirmModal() {
            document.getElementById('deleteConfirmModal').classList.add('hidden');
            currentTransactionId = null;
        }

        // Excluir transação
        function deleteTransaction() {
            if (currentTransactionId) {
                const transaction = transactions.find(t => t.id === currentTransactionId);
                if (transaction) {
                    // Reverter os efeitos da transação nos dados do dashboard
                    revertTransactionFromDashboard(transaction);
                }

                transactions = transactions.filter(t => t.id !== currentTransactionId);
                filterTransactions();
                updateDashboard(currentPeriod);
                closeDeleteConfirmModal();
            }
        }

        // Reverter os efeitos de uma transação nos dados do dashboard
        function revertTransactionFromDashboard(transaction) {
            for (const period in sampleData) {
                if (transaction.type === 'income') {
                    sampleData[period].income -= transaction.amount;
                    sampleData[period].profit -= transaction.amount;
                    sampleData[period].rides -= transaction.rides;

                    // Atualizar o último valor no gráfico de receitas
                    const lastIndex = sampleData[period].incomeExpensesData.income.length - 1;
                    sampleData[period].incomeExpensesData.income[lastIndex] -= transaction.amount;

                    // Atualizar o último valor no gráfico de lucro
                    const lastProfitIndex = sampleData[period].profitTrendData.data.length - 1;
                    sampleData[period].profitTrendData.data[lastProfitIndex] -= transaction.amount;

                    // Atualizar o último valor no gráfico de desempenho por dia
                    const lastWeekdayIndex = sampleData[period].weekdayPerformanceData.data.length - 1;
                    sampleData[period].weekdayPerformanceData.data[lastWeekdayIndex] -= transaction.amount;
                } else {
                    sampleData[period].expenses -= transaction.amount;
                    sampleData[period].profit += transaction.amount;

                    // Atualizar o último valor no gráfico de despesas
                    const lastIndex = sampleData[period].incomeExpensesData.expenses.length - 1;
                    sampleData[period].incomeExpensesData.expenses[lastIndex] -= transaction.amount;

                    // Atualizar o último valor no gráfico de lucro
                    const lastProfitIndex = sampleData[period].profitTrendData.data.length - 1;
                    sampleData[period].profitTrendData.data[lastProfitIndex] += transaction.amount;

                    // Atualizar o último valor no gráfico de desempenho por dia
                    const lastWeekdayIndex = sampleData[period].weekdayPerformanceData.data.length - 1;
                    sampleData[period].weekdayPerformanceData.data[lastWeekdayIndex] += transaction.amount;

                    // Atualizar categorias de despesas
                    if (transaction.amount > 0) {
                        const categoryIndex = sampleData[period].expenseCategoriesData.labels.indexOf(transaction.category);
                        if (categoryIndex !== -1) {
                            sampleData[period].expenseCategoriesData.data[categoryIndex] -= transaction.amount;

                            // Remover a categoria se o valor for zero
                            if (sampleData[period].expenseCategoriesData.data[categoryIndex] <= 0) {
                                sampleData[period].expenseCategoriesData.labels.splice(categoryIndex, 1);
                                sampleData[period].expenseCategoriesData.data.splice(categoryIndex, 1);
                            }
                        }
                    }
                }
            }
        }

        // Atualizar tabela de transações com paginação
        function updateTransactionsTable() {
            const tableBody = document.getElementById('transactionsTable');
            const paginationContainer = document.getElementById('pagination');
            const paginationInfo = document.getElementById('paginationInfo');

            tableBody.innerHTML = '';

            // Calcular paginação
            const totalPages = Math.ceil(filteredTransactions.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, filteredTransactions.length);
            const currentTransactions = filteredTransactions.slice(startIndex, endIndex);

            // Atualizar informações de paginação
            paginationInfo.textContent = `Mostrando ${currentTransactions.length} de ${filteredTransactions.length} transações`;

            // Renderizar transações
            currentTransactions.forEach(transaction => {
                const row = document.createElement('tr');

                const dateCell = document.createElement('td');
                dateCell.className = 'py-3 px-4';
                dateCell.textContent = formatDate(transaction.date);

                const descriptionCell = document.createElement('td');
                descriptionCell.className = 'py-3 px-4';
                descriptionCell.textContent = transaction.description;

                const categoryCell = document.createElement('td');
                categoryCell.className = 'py-3 px-4';
                categoryCell.textContent = transaction.category;

                const typeCell = document.createElement('td');
                typeCell.className = 'py-3 px-4';
                const typeSpan = document.createElement('span');
                typeSpan.className = transaction.type === 'income' ? 'bg-green-900 text-green-300 py-1 px-2 rounded-full text-xs' : 'bg-red-900 text-red-300 py-1 px-2 rounded-full text-xs';
                typeSpan.textContent = transaction.type === 'income' ? 'Entrada' : 'Saída';
                typeCell.appendChild(typeSpan);

                const amountCell = document.createElement('td');
                amountCell.className = 'py-3 px-4 ' + (transaction.type === 'income' ? 'text-green-500' : 'text-red-500');
                amountCell.textContent = formatCurrency(transaction.amount);

                const ridesCell = document.createElement('td');
                ridesCell.className = 'py-3 px-4';
                ridesCell.textContent = transaction.type === 'income' ? transaction.rides : '-';

                const actionsCell = document.createElement('td');
                actionsCell.className = 'py-3 px-4';
                actionsCell.innerHTML = `
                    <div class="flex space-x-2">
                        <svg class="w-5 h-5 text-blue-500 icon-btn edit-btn" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-id="${transaction.id}">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                        </svg>
                        <svg class="w-5 h-5 text-red-500 icon-btn delete-btn" fill="none" stroke="currentColor" viewBox="0 0 24 24" data-id="${transaction.id}">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                    </div>
                `;

                row.appendChild(dateCell);
                row.appendChild(descriptionCell);
                row.appendChild(categoryCell);
                row.appendChild(typeCell);
                row.appendChild(amountCell);
                row.appendChild(ridesCell);
                row.appendChild(actionsCell);

                tableBody.appendChild(row);
            });

            // Criar paginação
            createPagination(totalPages, paginationContainer);

            // Adicionar event listeners para os novos botões
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.dataset.id);
                    editTransaction(id);
                });
            });

            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.dataset.id);
                    openDeleteConfirmModal(id);
                });
            });
        }

        // Criar botões de paginação
        function createPagination(totalPages, container) {
            container.innerHTML = '';

            // Botão anterior
            const prevButton = document.createElement('button');
            prevButton.className = 'w-8 h-8 flex items-center justify-center rounded bg-gray-800 text-gray-400 pagination-btn';
            prevButton.innerHTML = `
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            `;
            prevButton.disabled = currentPage === 1;
            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    updateTransactionsTable();
                }
            });
            container.appendChild(prevButton);

            // Botões de página
            const maxVisiblePages = 3;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.className = `w-8 h-8 flex items-center justify-center rounded pagination-btn ${i === currentPage ? 'active bg-red-600 text-white' : 'bg-gray-800 text-gray-400'}`;
                pageButton.textContent = i;
                pageButton.addEventListener('click', () => {
                    currentPage = i;
                    updateTransactionsTable();
                });
                container.appendChild(pageButton);
            }

            // Botão próximo
            const nextButton = document.createElement('button');
            nextButton.className = 'w-8 h-8 flex items-center justify-center rounded bg-gray-800 text-gray-400 pagination-btn';
            nextButton.innerHTML = `
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            `;
            nextButton.disabled = currentPage === totalPages;
            nextButton.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    updateTransactionsTable();
                }
            });
            container.appendChild(nextButton);
        }

        // Exportar para PDF
        function exportToPdf() {
            const element = document.body;
            const opt = {
                margin: 10,
                filename: `relatorio-financeiro-${currentPeriod}.pdf`,
                image: {
                    type: 'jpeg',
                    quality: 0.98
                },
                html2canvas: {
                    scale: 2
                },
                jsPDF: {
                    unit: 'mm',
                    format: 'a4',
                    orientation: 'portrait'
                }
            };

            // Notificar o usuário
            alert('Preparando o PDF para download...');

            // Exportar
            html2pdf().set(opt).from(element).save();
        }

        // Formatar moeda
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        // Formatar data
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('pt-BR');
        }
    </script>
    <script>
        (function() {
            function c() {
                var b = a.contentDocument || a.contentWindow.document;
                if (b) {
                    var d = b.createElement('script');
                    d.innerHTML = "window.__CF$cv$params={r:'946d57c3026bf1c1',t:'MTc0ODQzMTAxNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";
                    b.getElementsByTagName('head')[0].appendChild(d)
                }
            }
            if (document.body) {
                var a = document.createElement('iframe');
                a.height = 1;
                a.width = 1;
                a.style.position = 'absolute';
                a.style.top = 0;
                a.style.left = 0;
                a.style.border = 'none';
                a.style.visibility = 'hidden';
                document.body.appendChild(a);
                if ('loading' !== document.readyState) c();
                else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c);
                else {
                    var e = document.onreadystatechange || function() {};
                    document.onreadystatechange = function(b) {
                        e(b);
                        'loading' !== document.readyState && (document.onreadystatechange = e, c())
                    }
                }
            }
        })();
    </script>
</body>

</html>